{% extends "index.html" %}

{% block script  %}
  <link rel="stylesheet" href="../css/datepicker.css">
  <link rel="stylesheet" href="../css/datatables.css">   
  <script src="../js/jquery.min.js"></script>
  <script src="../js/jquery.dataTables.min.js"></script>
  <script src="../js/bootstrap-datepicker.js"></script>
  <script src="../js/bootstrapPagination.js"></script>
  <script>
    $(document).ready(function() {

      $('#enterButton').click(function() {
        $('#enter_goal_modal').modal('show');
        $('#activity').attr('value', '');
        $('#operator').attr('value', 'total');
        $('#quantity').attr('value', '');
        $('#metric').attr('value', 'distance');
        $('#start_date').attr('value', '');
        $('#end_date').attr('value', '');
      });

      $('#closeButton').click(function() {
        $('#enter_goal_modal').modal('hide');
      });


      var goalsTable = $('#goalsTable').dataTable( {
        "bProcessing": true,
        "bServerSide": true,
        //"bLengthChange": false,
        "sPaginationType": "bootstrap",
        "sAjaxSource": "update_datatable",
        "sDom": "<'row'<'span6'l><'span6'f>r>t<'row'<'span6'i><'span6'p>>",
        "aoColumns": [
          { "mData": "activity", "bSearchable": false },
          { "mData": "operator", "bSearchable": false },
          { "mData": "quantity", "bSearchable": false },
          { "mData": "metric", "bSearchable": false },
          { "mData": "start_date", "bSearchable": false },
          { "mData": "end_date", "bSearchable": false },
          { "mData": "completed", "bSearchable": false }
        ]
      } );

      // for submitting the new goal
      $("form").submit(function() {
        $.post("create", $(this).serialize(), function() {
          goalsTable.fnDraw();
        } );
        return false;
      } );



      // for the start and end date inputs
      $('#startDate').datepicker();
      $('#endDate').datepicker();

    } );
  </script>


  <script>

  </script>
{% endblock script %}

{% block body %}

    <div class="modal hide fade" id="enter_goal_modal" name="enter_activity_modal">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            <h3 id="modal_title">Create Goal:</h3>
        </div>

      <form class="form-inline well" action="createGoal">

        <div class="modal-body">
        <div class="control-group">
          <!-- TODO: fill with activity types from db in script-->
          <select class="span2" name="activity" id="activity">
            <option value="run">Run</option>
            <option value="bike">Bike</option>
            <option value="swim">Swim</option>
          </select>

          <!-- TODO: fill with operator types from db in script-->
          <select class="span2" name="operator" id="operator">
            <option value="total">Total</option>
            <option value="min">Min</option>
            <option value="max">Max</option>
            <option value="average">Average</option>
          </select>

          <input class="span2" type="text" name="quantity" id="quantity" placeholder="Quantity" required >
          
          <!-- TODO: fill with metric types from db in script-->
          <select class="span2" name="metric" id="metric">
            <option value="distance">Distance</option>
            <option value="max_speed">Max Speed</option>
          </select>
        </div>

        <div class="control-group">
          <!-- TODO: make default current date -->
          Start:
          <div class="input-append date" id="start_date" data-date="26-02-2013" data-date-format="dd-mm-yyyy">
            <input class="span2" name="start_date" size="16" type="text" value="26-02-2013">
            <span class="add-on"><i class="icon-th"></i></span>
          </div>
          
          <!-- TODO: make default current date +1 day-->
          End:
          <div class="input-append date" id="end_date" data-date="27-02-2013" data-date-format="dd-mm-yyyy">
            <input class="span2" name="end_date" size="16" type="text" value="27-02-2013">
            <span class="add-on"><i class="icon-th"></i></span>
          </div>

        </div>
      </div>

      <div class="modal-footer">
          <a class="btn" id="closeButton">Close</a>
          <input class="btn btn-primary" id="saveButton" type="submit" value="Create" />
      </div>

    </form>
</div>

  <!-- CURRENT GOALS TABLE -->

  <div align="left">
      <button type="button" id="enterButton" class="btn">Enter a New Goal:</button>
  </div>

  <form class="form-horizontal well">
    <legend>Goals</legend>

    <table class="table table-bordered table-striped table-hover" id="goalsTable">
      <thead>
      <tr>
        <th>Activity</th>
        <th>Operator</th>
        <th>Quantity</th>
        <th>Metric</th>
        <th>Start</th>
        <th>End</th>
        <th>Completed</th>
      </tr>
    </thead>
    <tbody>
    </tbody>
    </table>
  </form>

{% endblock body %}
